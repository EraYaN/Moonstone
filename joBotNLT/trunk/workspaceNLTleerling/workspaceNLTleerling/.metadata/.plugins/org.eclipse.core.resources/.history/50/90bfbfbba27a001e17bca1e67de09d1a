/*
 * Created on Aug 13, 2004
 * DriveTestJrBehavior (dip=5) drives the robot in a straight
 * line at various speeds
 */
package javaBot.Nano.Rescue;

import com.muvium.apt.PeriodicTimer;

/**
 * Opdracht 4C - Vooruit rijden en stop na 2 sec
 * Opdracht 4D - Een bocht maken
 * Opdracht 4E - maak een subroutine
 * Opdracht 4F - Rijd in een vierkantje 
 * In deze les rijdt de robot 2 seconden vooruit
 * Daarna maakt hij een bocht en kunnen we een patroon volgen
 **/

public class DriveBehavior04 extends Behavior
{
	private BaseController	joBot;
	private int	state	= 0;
	private int	count	= 0;
	int sl = 0;
	
	public DriveBehavior04(BaseController initJoBot, PeriodicTimer initServiceTick,
			int servicePeriod)
	{
		super(initJoBot, initServiceTick, servicePeriod);
		joBot = initJoBot;
	}

	public void doBehavior() {
// 		Code voor opdracht 4A
		if (state == 0) {
			joBot.drive(50, 50);
		    joBot.setStatusLeds(false, false, false); // Turn leds off
//			Count toevoegen in opdracht 4B.3
		    count++;
//			State laten zien in opdracht 4B.4
		    joBot.printLCD("State=0");
		    if (count >= 20) {
		    	joBot.setStatusLeds(true, false, false); // Turn yellow on
		    	state = 1;
		    	count = 0;    // opdracht 4d
		    }
		}	
		
// Deze code voor opdracht 4B, wordt in 4F veranderd in state == 2
		if (state == 1) {     // Opdracht 4B
			joBot.drive(0,0);
			joBot.printLCD("State=1");
		}
		
// Nieuwe state toevoegen voor maken van een bocht opdracht 4f
		if (state == 2) {      // Opdracht 4f
			joBot.drive(50,30);
			count++;
		    if (count >= 10) {
		    	joBot.setStatusLeds(false, true, false); 
		    	// Turn green on
		    	state = 2;
		    	count = 0;    // Opdracht 4f
		    }
		}
	
// Aanpassen voor opdracht 4f
		if (state == 3) {     // Opdracht 4f
			joBot.drive(0,0);
		}
	}
	
// Gebruiken van een subroutine - Opdracht 4i
// De opdracht kunnen we ook schrijven als:
//	jobotDrive (0, 1, 50, 50, 20);
//	jobotDrive (0, 1, 50, 50, 20);
	
	private void jobotDrive (int state, int newState, int l, int r, int t) {
		if (state == state) {      // Opdracht 4d
			joBot.drive(l,r);
		    if (count++ >= t) {
		    	state = newState;
		    	count = 0;         // opdracht 4d
		    }
      }
		
// Voorbeeld gebruik van een Case statement - Opdracht 4k		
// Dit is een simpeler manier om de states te selecteren		
		switch (state) {
		case 1:
			// Code voor state == 1
			break;
		case 2:
			// Code voor state == 2
			break;
		default:
			System.out.print("State niet bekend: ");
			System.out.println(state);
			break;
		}
					
	}
}
