package javaBot.Nano.Rescue;

import com.muvium.apt.PeriodicTimer;

/**
 * Opdracht 4A - Vooruit rijden
 * Opdracht 4B - Twee seconden lang rijden
 * Opdracht 4C - Vooruit rijden en stop na 2 sec
 * Opdracht 4D - Een bocht maken
 * Opdracht 4E - maak een subroutine
 * Opdracht 4F - Rijd in een vierkantje 
 * In deze les rijdt de robot 2 seconden vooruit
 * Daarna maakt hij een bocht en kunnen we een patroon volgen
 **/

public class DriveBehavior05X extends Behavior
{
	private BaseController	joBot;
	private int	state	= 0;
	private int	count	= 0;
	int ds = 0;
	
	public DriveBehavior05X(BaseController initJoBot, PeriodicTimer initServiceTick,
			int servicePeriod) {
		super(initJoBot, initServiceTick, servicePeriod);
		joBot = initJoBot;
	}

	public void doBehavior() {
// 		Code voor opdracht 4b
		if (state == 0) {
			joBot.drive(50, 50);
		    joBot.setStatusLeds(false, false, false); // Turn leds off
		    
// 			Toevoegen controle op zwarte lijn
		    sl = joBot.getSensorValue(joBot.SENSOR_FL);
		    if (sl < 400) {  // Test if black
		    	joBot.setStatusLeds(false, false, true);
		    	// Turn on blue when line is detected
		    	state = 1;   // Opdracht 5b
		    }
//			Count toevoegen in opdracht 4d
		    count++;
		    if (count >= 20) {
		    	joBot.setStatusLeds(true, false, false); 
		    	// Turn yellow on
		    	state = 1;
		    	count = 0;    // Opdracht 4d
		    }
		}	
		
// Deze code voor opdracht 4b, wordt in 4f veranderd in state == 2
//		if (state == 1) {     // Opdracht 4b
//			joBot.drive(0,0);
//		}
		
// Nieuwe state toevoegen voor maken van een bocht opdracht 4f
		if (state == 1) {      // Opdracht 4f
			joBot.drive(50,30);
			count++;
		    if (count >= 10) {
		    	joBot.setStatusLeds(false, true, false); 
		    	// Turn green on
		    	state = 2;
		    	count = 0;    // Opdracht 4f
		    }
		}
	
// Aanpassen voor opdracht 4f
		if (state == 2) {     // Opdracht 4f
			joBot.drive(0,0);
		}
	}
	
// Gebruiken van een subroutine - Opdracht 4i
// De opdracht kunnen we ook schrijven als:
//	jobotDrive (0, 1, 50, 50, 20);
//	jobotDrive (0, 1, 50, 50, 20);
	
	private void jobotDrive (int state, int newState, int l, int r, int t) {
		if (state == state) {      // Lesson 4d
			joBot.drive(l,r);
		    if (count++ >= t) {
		    	state = newState;
		    	count = 0;    // Lesson 4d
		    }
      }
		
// Voorbeeld gebruik van een Case statement - Opdracht 4k		
// Dit is een simpeler manier om de states te selecteren		
		switch (state) {
		case 1:
			// Code voor state == 1
			break;
		case 2:
			// Code voor state == 2
			break;
		default:
			System.out.print("State niet bekend: ");
			System.out.println(state);
			break;
		}
					
	}
}
