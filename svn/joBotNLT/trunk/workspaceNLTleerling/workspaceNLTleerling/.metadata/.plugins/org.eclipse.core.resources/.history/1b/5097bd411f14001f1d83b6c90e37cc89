package javaBot.Nano.Grid;

import com.muvium.apt.PeriodicTimer;

/**
 * Opdracht - 10a Basis wall follower
 * WallFollowerBehavior is eenvoudige wall-folower die een
 * sensor gebruikt. De afstand tot de muur wordt gemeten
 * en het terugkoppelmechanisme probeert de afstand 
 * gelijk te houden.
 */

public class WallFollowerBehavior10 extends Behavior
{
	private BaseController	joBot;
	private int WALL_DIST = 20;
	private int speed = 30;	
	
	public WallFollowerBehavior10(BaseController initJoBot, PeriodicTimer initServiceTick,
			int servicePeriod)
	{
		super(initJoBot, initServiceTick, servicePeriod);
		joBot = initJoBot;
		}

	public void doBehavior()
	{
		int ds = 0;
		int diff = 0;

		// Find minumum distance
		ds = joBot.getSensorValue(joBot.SENSOR_DS);
		joBot.setStatusLeds(false, false, false);

		// Opdracht 10b
		diff = ds * 100 / WALL_DIST;
		speed = 100 - (diff * 30 / 100);
		System.out.print("Diff=");
		System.out.println(diff);

		if (ds < WALL_DIST) {   // If wall lost
			joBot.setLed(joBot.LED_GREEN, true);
			joBot.drive(speed, speed/2);	// Go left
		}
		
		if (ds >= WALL_DIST) {    // If wall found
			joBot.setLed(joBot.LED_YELLOW, true);
			joBot.drive(speed/4, speed);	// Go right
		}

	}
}
